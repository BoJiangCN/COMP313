@model WeLinkUp.Models.EventDetailModel
@using Microsoft.AspNetCore.Identity;
@inject SignInManager<ApplicationUser> signInManager;

@{ ViewData["Title"] = "Event Details"; }

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <style>
        body, h1, h2, h3, h4, h5 {
            font-family: "Lato", sans-serif
        }
        /*image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);*/
            /*// For vertical blocks (i.e., where height is greater than width)*/ 
            /*height: 100%;
            width: auto;*/
            /*// For horizontal blocks (i.e., where width is greater than height)*/ 
            /*height: auto;
            width: 100%;
        }*/
        .image {
            height: 200px;
            width: 100%;
            object-fit: contain;
        }
        .w3-row {
            margin-left: 20%;
            width: 60%;
        }
        .w3-col l8 s12 {
        
            width:20%;
        }

    </style>
</head>
<body class="w3-light-grey">
    <!-- Header -->
    <br/>
    <br/>
    <header class="w3-container w3-center w3-padding-32">
        <h1><b>Event Detail</b></h1>
        <p>Welcome to the event of <span class="w3-tag">@Model.Host</span></p>
    </header>
    <!-- Grid -->
    <div class="w3-row">

        <!-- Blog entries -->
        <div class="w3-col l8 s12">
            <!-- Blog entry -->
            <div class="w3-card-4 w3-margin w3-white">
                <div class="image">
                    <img src="@Url.Content("~/images/EventPicture/" + Model.Image)" alt="Nature" style='height: 100%; width: 100%; object-fit: contain'>

                </div>
                <div class="w3-container">
                    <h3><b>@Model.EventTitle</b></h3>
                    <h5>Title description, <span class="w3-opacity">@Model.Date</span></h5>
                </div>

                <div class="w3-container">
                    <p>
                        @Model.Description
                    </p>
                    <div class="w3-row">
                        <div class="w3-col m8 s12">
                            <p><button class="w3-button w3-padding-large w3-white w3-border"><b>READ MORE �</b></button></p>
                        </div>
                        <div class="w3-col m4 w3-hide-small">
                            <p><span class="w3-padding-large w3-right"><b>Comments �</b> <span class="w3-tag">0</span></span></p>
                        </div>
                    </div>
                </div>
                <h3><b>Invitation List</b></h3>
                @foreach (AttendeeList user in Model.AttendeeList)
                {
                    <form>
                        <input type="text" value="@user.Username" />
                        <input type="text" value="@user.Status" />
                    </form>
                }
            </div>
            @if (DateTime.Compare(DateTime.Now.Date, Convert.ToDateTime(Model.Date)) > 0)
            {
                <h3>Event is already passed1</h3>
            }
            else if (DateTime.Compare(DateTime.Now, Convert.ToDateTime(Model.Date)) == 0 && DateTime.Compare(DateTime.Now, Convert.ToDateTime(Model.EndTime)) > 0)
            {
                <h3>@DateTime.Compare(DateTime.Now, Convert.ToDateTime(Model.EndTime))</h3>
                <h3>Event is already passed2</h3>
            }

            else
            {

                @if (ViewData["Attendance"].ToString() == "1")
                {
                    @if (ViewData["BlockTeenager"] != null && ViewData["BlockTeenager"].ToString() == "1")
                    {
                        <button disabled>This event is adult only</button>
                    }
                    else
                    {
                        if (ViewData["Freeday"].ToString() == "0")
                        {
                            <button name="joinEvent" id="btnJoinEvent" class="btn btn-secondary" onclick="timeAlert(); location.href = '@Url.Action("JoinEvent", new { eventId = Model.EventId })'; return false;">Join Event</button>
                        }
                        else
                        {
                            <p1>@ViewData["Freeday"].ToString()</p1>
                            <button name="joinEvent" id="btnJoinEvent" class="btn btn-secondary" onclick="location.href = '@Url.Action("JoinEvent", new { eventId = Model.EventId })'; return false;">Join Event</button>
                        }
                    }
                }

                else if (ViewData["Attendance"].ToString() == "2")
                {
                    <p>You are coming to this event</p>
                }

                else if (Model.HostId.Equals(signInManager.UserManager.GetUserId(User)))
                {
                    <button name="modifyEvent" id="btnModifyEvent" class="btn btn-secondary">Modify Event</button>
                    <button name="cancelEvent" id="btnCancelEvent" class="btn btn-secondary">Cancel Event</button>
                }


            }

            <hr>


        </div>

        <!-- Info -->
        <div class="w3-col l4">
            <!-- Location -->
            <div class="w3-card w3-margin w3-margin-top">
                <div class="w3-container w3-white">
                    <h4><b>Location</b></h4>
                    <p>@Model.Location</p>
                </div>
            </div><hr>
            <!-- DateTime -->
            <div class="w3-card w3-margin w3-margin-top">
                <div class="w3-container w3-white">
                    <h4><b>Date</b></h4>                   
                    <p>@Model.DayOfWeek, @Model.Date</p>
                    <p>@Model.StartTime To @Model.EndTime</p>
                </div>
            </div><hr>



        </div>











    </div>

    <br />
    <br />

    

    

</body>
</html>


<script>
    function timeAlert() {
        alert("Warning! Time is confliect with your free time");
    }
</script>
